<script setup name="backstage:tool:code">
import { ref, reactive } from 'vue'
import { ElMessage } from 'element-plus'
const formJson = reactive({"widgetList":[{"key":26137,"type":"date-range","icon":"date-range-field","formItemFlag":true,"options":{"name":"date","label":"日期","labelAlign":"label-right-align","type":"daterange","defaultValue":["2024-03-01","2024-04-16"],"startPlaceholder":"开始日期","endPlaceholder":"结束日期","columnWidth":"200px","size":"","autoFullWidth":false,"labelWidth":"","labelHidden":false,"readonly":false,"disabled":false,"hidden":false,"clearable":true,"editable":true,"format":"YYYY/MM/DD","valueFormat":"YYYY-MM-DD","required":true,"requiredHint":"请输入日期","validation":"","validationHint":"","customClass":["date-class"],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"","onMounted":"","onChange":"","onFocus":"","onBlur":"","onValidate":""},"id":"daterange43906"},{"key":59460,"type":"radio","icon":"radio-field","formItemFlag":true,"options":{"name":"radio","label":"水果","labelAlign":"label-right-align","defaultValue":"yingtao","columnWidth":"200px","size":"","displayStyle":"inline","buttonStyle":false,"border":false,"labelWidth":"","labelHidden":false,"disabled":false,"hidden":false,"optionItems":[{"label":"香蕉","value":"xiangjiao"},{"label":"樱桃","value":"yingtao"},{"label":"苹果","value":"pingguo"}],"required":true,"requiredHint":"请选择水果","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"console.log('radio 已创建')","onMounted":"console.log('radio 已挂载')","onChange":"console.log('radio值改变：', value, oldValue)","onValidate":""},"id":"radio68047"},{"key":62127,"type":"radio","icon":"radio-field","formItemFlag":true,"options":{"name":"drink","label":"喜欢喝酒还是饮料？","labelAlign":"label-right-align","defaultValue":"beverage","columnWidth":"200px","size":"","displayStyle":"inline","buttonStyle":false,"border":false,"labelWidth":"","labelHidden":false,"disabled":false,"hidden":false,"optionItems":[{"label":"喝酒","value":"wine"},{"label":"喝饮料","value":"beverage"}],"required":true,"requiredHint":"请选择喜欢喝酒还是饮料","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"","onMounted":"","onChange":"var wineTypeWidget = this.getWidgetRef('wineType')\nvar beverageTypeWidget = this.getWidgetRef('beverageType')\n\nif (value === 'wine') {\n  wineTypeWidget.setHidden(false)\n  beverageTypeWidget.setHidden(true)\n} else if (value === 'beverage') {\n  beverageTypeWidget.setHidden(false)\n  wineTypeWidget.setHidden(true)\n}","onValidate":""},"id":"radio8727"},{"key":50054,"type":"select","icon":"select-field","formItemFlag":true,"options":{"name":"wineType","label":"喜欢喝什么酒？","labelAlign":"label-right-align","defaultValue":2,"placeholder":"请选择","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"disabled":false,"hidden":true,"clearable":true,"filterable":false,"allowCreate":false,"remote":false,"automaticDropdown":false,"multiple":false,"multipleLimit":0,"optionItems":[{"label":"白酒","value":1},{"label":"红酒","value":2},{"label":"啤酒","value":3}],"required":false,"requiredHint":"","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"","onMounted":"","onRemoteQuery":"","onChange":"","onFocus":"","onBlur":"","onValidate":""},"id":"select104191"},{"key":62127,"type":"radio","icon":"radio-field","formItemFlag":true,"options":{"name":"beverageType","label":"喜欢喝什么饮料？","labelAlign":"label-right-align","defaultValue":3,"columnWidth":"200px","size":"","displayStyle":"inline","buttonStyle":false,"border":false,"labelWidth":"","labelHidden":false,"disabled":false,"hidden":false,"optionItems":[{"label":"可乐","value":1},{"label":"雪碧","value":2},{"label":"王老吉","value":3}],"required":true,"requiredHint":"请选择饮料种类","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"","onMounted":"","onChange":"","onValidate":""},"id":"radio49825"},{"key":28936,"type":"select","icon":"select-field","formItemFlag":true,"options":{"name":"province","label":"省份","labelAlign":"label-right-align","defaultValue":"1","placeholder":"请选择","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"disabled":false,"hidden":false,"clearable":true,"filterable":false,"allowCreate":false,"remote":false,"automaticDropdown":false,"multiple":false,"multipleLimit":0,"optionItems":[{"label":"江西省","value":"1"},{"label":"广东省","value":2}],"required":false,"requiredHint":"","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"","onMounted":"","onRemoteQuery":"","onChange":"const cityRef = this.getWidgetRef('city')\n\nif (value == 1) {\n  cityRef.loadOptions([\n    { value: 1, label: '宜春市' },\n    { value: 2, label: '南昌市' },\n  ])\n  cityRef.setValue(null)\n} else if (value == 2) {\n  cityRef.loadOptions([\n    { value: 1, label: '深圳市' },\n    { value: 2, label: '广州市' },\n  ])\n  cityRef.setValue(null)\n}","onFocus":"","onBlur":"","onValidate":""},"id":"select27107"},{"key":28936,"type":"select","icon":"select-field","formItemFlag":true,"options":{"name":"city","label":"城市","labelAlign":"label-right-align","defaultValue":1,"placeholder":"请选择","columnWidth":"200px","size":"","labelWidth":null,"labelHidden":false,"disabled":false,"hidden":false,"clearable":true,"filterable":false,"allowCreate":false,"remote":false,"automaticDropdown":false,"multiple":false,"multipleLimit":0,"optionItems":[{"value":1,"label":"宜春市"},{"value":2,"label":"南昌市"}],"required":false,"requiredHint":"","validation":"","validationHint":"","customClass":[],"labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"","onMounted":"","onRemoteQuery":"","onChange":"","onFocus":"","onBlur":"","onValidate":""},"id":"select37931"},{"key":67253,"type":"static-text","icon":"static-text","formItemFlag":false,"options":{"name":"statictext105343","columnWidth":"200px","hidden":false,"textContent":"基础内容","customClass":["title-text"],"onCreated":"","onMounted":"","label":"static-text"},"id":"statictext105343"},{"key":70145,"type":"file-upload","icon":"file-upload-field","formItemFlag":true,"options":{"name":"fileupload94692","label":"file-upload","labelAlign":"","labelWidth":null,"labelHidden":false,"columnWidth":"200px","disabled":false,"hidden":false,"required":false,"requiredHint":"","customRule":"","customRuleHint":"","uploadURL":"","uploadTip":"","withCredentials":false,"multipleSelect":false,"showFileList":true,"limit":3,"fileMaxSize":5,"fileTypes":["doc","docx","xls","xlsx"],"customClass":"","labelIconClass":null,"labelIconPosition":"rear","labelTooltip":null,"onCreated":"","onMounted":"","onBeforeUpload":"","onUploadSuccess":"","onUploadError":"","onFileRemove":"","onValidate":""},"id":"fileupload94692"}],"formConfig":{"modelName":"formData","refName":"vFormRef","rulesName":"formDataRules","labelWidth":150,"labelPosition":"left","size":"","labelAlign":"label-right-align","cssCode":".title-text {\n  font-size: 20px;\n  font-weight: bold;\n}","customClass":[],"functions":"","layoutType":"PC","jsonVersion":3,"onFormCreated":"","onFormMounted":"const cityRef = this.getWidgetRef('city')\nsetTimeout(() => {\n  cityRef.loadOptions([\n    { value: 1, label: '宜春市' },\n    { value: 2, label: '南昌市' }\n  ])\n}, 3000)","onFormDataChange":""}})
const formData = reactive({
  // date: ['2021-05-09', '2024-02-25']
})
const optionData = reactive({})
const vFormRef = ref(null)

const submitForm = () => {
    vFormRef.value.getFormData().then(formData => {
      alert(JSON.stringify(formData))
      console.log(formData)
    }).catch(error => {
      ElMessage.error(error)
    })
  }
</script>

<template>
  <div class="page_container code_page">
    <v-form-render ref="vFormRef" :form-json="formJson" :form-data="formData" :option-data="optionData"></v-form-render>
    <el-button type="primary" @click="submitForm">提交</el-button>
  </div>
</template>

<style scoped lang="scss">
.code_page {
  
}
</style>